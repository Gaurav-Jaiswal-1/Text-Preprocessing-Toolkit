[tox]
envlist = py38, py39, py310

[gh-actions]
python = 
    3.8: py38
    3.9: py39
    3.10: py310

[testenv]
deps = 
    -rrequirements_dev.txt
    flake8
    mypy
    pytest
    pytest-cov
commands = 
    # Linting for syntax errors and style issues
    flake8 src --count --select=E9,F63,F7,F82 --show-source --statistics
    flake8 src --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
    
    # Static type checking
    mypy src/
    
    # Unit tests with coverage
    pytest --cov=src tests/unit --cov-report=term-missing
    
    # Integration tests
    pytest -v tests/integration

[testenv:lint]
description = Run linting tools (flake8 and mypy)
deps = 
    flake8
    mypy
commands = 
    flake8 src --count --select=E9,F63,F7,F82 --show-source --statistics
    flake8 src --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
    mypy src/

[testenv:unit]
description = Run only unit tests
deps = 
    pytest
    pytest-cov
commands = 
    pytest --cov=src tests/unit --cov-report=term-missing

[testenv:integration]
description = Run only integration tests
deps = 
    pytest
commands = 
    pytest -v tests/integration

[flake8]
max-line-length = 127
max-complexity = 10
exclude = 
    .tox,
    .git,
    __pycache__,
    build,
    dist

[mypy]
ignore_missing_imports = true
strict = true
incremental = true

[pytest]
addopts = --verbose
testpaths = tests
